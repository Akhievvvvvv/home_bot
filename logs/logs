# bot/utils/logger.py
import logging
from logging.handlers import TimedRotatingFileHandler
import os

# Создаем папку logs, если ее нет
if not os.path.exists("logs"):
    os.makedirs("logs")

# Основной логгер
logger = logging.getLogger("vpn_bot")
logger.setLevel(logging.INFO)

# Формат логов
formatter = logging.Formatter(
    "%(asctime)s | %(levelname)s | %(name)s | %(message)s", datefmt="%Y-%m-%d %H:%M:%S"
)

# Логи работы бота (ротация каждый день)
file_handler = TimedRotatingFileHandler("logs/bot.log", when="midnight", backupCount=30, encoding="utf-8")
file_handler.setFormatter(formatter)
file_handler.setLevel(logging.INFO)

# Логи ошибок
error_handler = TimedRotatingFileHandler("logs/errors.log", when="midnight", backupCount=30, encoding="utf-8")
error_handler.setFormatter(formatter)
error_handler.setLevel(logging.ERROR)

# Консольный вывод
console_handler = logging.StreamHandler()
console_handler.setFormatter(formatter)
console_handler.setLevel(logging.INFO)

# Добавляем обработчики
logger.addHandler(file_handler)
logger.addHandler(error_handler)
logger.addHandler(console_handler)

# Пример использования
if __name__ == "__main__":
    logger.info("Бот запущен")
    logger.error("Пример ошибки")
    logger.info("Пользователь #7231676236 купил 1 месяц VPN за 49⭐️")
